
R version 3.0.1 (2013-05-16) -- "Good Sport"
Copyright (C) 2013 The R Foundation for Statistical Computing
Platform: x86_64-w64-mingw32/x64 (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> require(DoE.base)
Loading required package: DoE.base
Loading required package: vcd
Loading required package: MASS
Loading required package: grid
Loading required package: colorspace
Loading required package: conf.design

Attaching package: 'DoE.base'

The following object is masked from 'package:stats':

    aov, lm

The following object is masked from 'package:graphics':

    plot.design

> set.seed(9890)
> plan <- oa.design(nlevels=c(2,6,2), replications=2, repeat.only=TRUE)
> y <- rnorm(24)
> plan <- reptowide(add.response(plan,y))
> aggregate(plan)
   A B C         y.1        y.2       y.mean
1  1 5 1  0.01935135 -1.2708067 -0.625727661
2  2 2 1  0.65334512 -0.1627274  0.245308864
3  2 5 2  0.59648126  1.7117503  1.154115800
4  2 3 2 -0.31295797 -0.5164814 -0.414719692
5  2 4 1  1.62571967 -0.6131808  0.506269458
6  1 6 2 -0.82288854  0.9506755  0.063893500
7  1 1 1 -1.09169787  0.3049802 -0.393358827
8  1 3 1 -0.77287005  0.8944260  0.060777983
9  2 1 2 -0.83170543 -1.1183558 -0.975030595
10 2 6 1 -1.14492138  0.5610340 -0.291943686
11 1 4 2  0.23347780 -0.2243080  0.004584888
12 1 2 2 -1.36868861 -0.2820471 -0.825367843
class=design, type= oa 
> 
> plan <- param.design(oa.design(nlevels=c(2,6,2), factor.names=c("C1","C2","C3")), oa.design(ID=L4.2.3))
> y <- rnorm(48)
> plan <- paramtowide(add.response(plan,y))
> aggregate(plan)
   run.no run.no.std.rp C1 C2 C3        y.1         y.2         y.3         y.4
1       1            11  2  3  2  0.1099378  0.23011212 -1.10359780 -1.88117642
2       2             5  1  4  2  0.3729805  1.74655654 -0.59170249  1.71772666
3       3             2  1  3  1 -0.2503562  0.61049980  0.99571035 -0.73043786
4       4             7  2  2  1 -0.3093983 -0.23286547 -0.28341418  1.12137893
5       5             6  1  6  2  0.4971070  1.52979749  1.94188828  1.81914949
6       6             1  1  1  1  1.6625073 -0.59415395  1.14095580 -0.24550554
7       7             3  1  5  1  0.4378391 -0.45887515  0.12444789  0.99735172
8       8             8  2  4  1  0.1450211 -0.07370278  1.40412600 -1.47756548
9       9            12  2  5  2  0.9578251 -0.42374223  0.01931359 -0.73269604
10     10            10  2  1  2  0.2707627  1.02332244  1.93977514  2.35642337
11     11             9  2  6  1  0.3801208  1.30226037 -1.52575652 -1.47408531
12     12             4  1  2  2 -0.1292387  0.30212159 -0.39821718 -0.03870631
          y.mean
1  -0.6611810747
2   0.8113903024
3   0.1563540105
4   0.0739252420
5   1.4469855639
6   0.4909509168
7   0.2751908884
8  -0.0005302827
9  -0.0448248948
10  1.3975709190
11 -0.3293651650
12 -0.0660101590
class=design, type= oa.paramwide 
NOTE: columns run.no and run.no.std.rp are annotation, not part of the data frame
Outer array:
  A B C
1 1 2 2
2 2 2 1
3 2 1 2
4 1 1 1
> aggregate(plan,response="y")
   run.no run.no.std.rp C1 C2 C3        y.1         y.2         y.3         y.4
1       1            11  2  3  2  0.1099378  0.23011212 -1.10359780 -1.88117642
2       2             5  1  4  2  0.3729805  1.74655654 -0.59170249  1.71772666
3       3             2  1  3  1 -0.2503562  0.61049980  0.99571035 -0.73043786
4       4             7  2  2  1 -0.3093983 -0.23286547 -0.28341418  1.12137893
5       5             6  1  6  2  0.4971070  1.52979749  1.94188828  1.81914949
6       6             1  1  1  1  1.6625073 -0.59415395  1.14095580 -0.24550554
7       7             3  1  5  1  0.4378391 -0.45887515  0.12444789  0.99735172
8       8             8  2  4  1  0.1450211 -0.07370278  1.40412600 -1.47756548
9       9            12  2  5  2  0.9578251 -0.42374223  0.01931359 -0.73269604
10     10            10  2  1  2  0.2707627  1.02332244  1.93977514  2.35642337
11     11             9  2  6  1  0.3801208  1.30226037 -1.52575652 -1.47408531
12     12             4  1  2  2 -0.1292387  0.30212159 -0.39821718 -0.03870631
          y.mean
1  -0.6611810747
2   0.8113903024
3   0.1563540105
4   0.0739252420
5   1.4469855639
6   0.4909509168
7   0.2751908884
8  -0.0005302827
9  -0.0448248948
10  1.3975709190
11 -0.3293651650
12 -0.0660101590
class=design, type= oa.paramwide 
NOTE: columns run.no and run.no.std.rp are annotation, not part of the data frame
Outer array:
  A B C
1 1 2 2
2 2 2 1
3 2 1 2
4 1 1 1
> 
> plan <- param.design(oa.design(nlevels=c(2,6,2), factor.names=c("C1","C2","C3")), oa.design(ID=L4.2.3))
> plan <- paramtowide(plan)
> aggregate(plan)
   run.no run.no.std.rp C1 C2 C3 y.1 y.2 y.3 y.4 y.mean
1       1             3  1  5  1  NA  NA  NA  NA     NA
2       2             4  1  2  2  NA  NA  NA  NA     NA
3       3             5  1  4  2  NA  NA  NA  NA     NA
4       4            10  2  1  2  NA  NA  NA  NA     NA
5       5            12  2  5  2  NA  NA  NA  NA     NA
6       6             9  2  6  1  NA  NA  NA  NA     NA
7       7            11  2  3  2  NA  NA  NA  NA     NA
8       8             7  2  2  1  NA  NA  NA  NA     NA
9       9             2  1  3  1  NA  NA  NA  NA     NA
10     10             1  1  1  1  NA  NA  NA  NA     NA
11     11             8  2  4  1  NA  NA  NA  NA     NA
12     12             6  1  6  2  NA  NA  NA  NA     NA
class=design, type= oa.paramwide 
NOTE: columns run.no and run.no.std.rp are annotation, not part of the data frame
Outer array:
  A B C
1 2 1 2
2 1 1 1
3 2 2 1
4 1 2 2
> 
> plan <- cross.design(oa.design(nlevels=c(2,6,2), factor.names=c("C1","C2","C3")), oa.design(ID=L4.2.3,replications=2,repeat.only=TRUE))
> y <- rnorm(96)
> plan <- reptowide(add.response(plan,y))
> aggregate(plan)
   run.no run.no.std.rp C1 C2 C3 A B C          y.1         y.2      y.mean
1       1           2_1  1  3  1 2 1 2 -0.851150416 -1.05302532 -0.95208787
2       2           2_3  1  5  1 2 2 1  0.006271484 -0.90117767 -0.44745310
3       3           2_4  1  2  2 2 2 1  0.548169124  0.54762139  0.54789526
4       4           2_2  1  6  2 1 1 1 -0.181851424 -0.78673867 -0.48429505
5       5           8_1  2  3  2 1 2 2 -1.235746194 -0.74992867 -0.99283743
6       6           8_3  1  5  1 1 1 1  0.813509703 -0.27667395  0.26841788
7       7           8_4  2  2  1 2 1 2 -0.508715302 -0.70463704 -0.60667617
8       8           8_2  1  2  2 2 1 2 -0.727584111 -0.23652282 -0.48205347
9       9           3_1  2  1  2 1 1 1 -0.232593151 -1.11208911 -0.67234113
10     10           3_3  2  5  2 1 1 1 -0.930863963  1.42213606  0.24563605
11     11           3_4  1  2  2 1 2 2  0.143687239  2.74344725  1.44356724
12     12           3_2  2  2  1 2 2 1 -1.822179128 -0.62036368 -1.22127141
13     13          10_1  1  5  1 1 2 2  0.382546265 -0.18896758  0.09678934
14     14          10_3  2  3  2 2 2 1  1.305736592  2.78390388  2.04482024
15     15          10_4  2  1  2 2 2 1 -0.249175840  0.51246844  0.13164630
16     16          10_2  2  6  1 2 2 1 -0.374453991 -0.37659472 -0.37552436
17     17           5_1  1  3  1 2 2 1 -0.881303105 -0.87684691 -0.87907500
18     18           5_3  2  6  1 2 1 2 -0.359864883 -0.29522781 -0.32754635
19     19           5_4  2  6  1 1 1 1 -1.537593318 -0.06627631 -0.80193481
20     20           5_2  1  3  1 1 1 1  0.854983068 -0.71287670  0.07105318
21     21          11_1  2  4  1 2 2 1  0.159779702  1.82256585  0.99117278
22     22          11_3  1  6  2 2 1 2 -0.924768441 -0.51237670 -0.71857257
23     23          11_4  1  1  1 2 2 1 -1.005049325 -0.38943788 -0.69724360
24     24          11_2  2  3  2 1 1 1 -1.503285614  0.44597042 -0.52865760
25     25           6_1  1  2  2 1 1 1 -1.297851905  1.06399304 -0.11692943
26     26           6_3  2  2  1 1 1 1 -0.081346903 -0.14771380 -0.11453035
27     27           6_4  1  1  1 1 2 2 -0.551597973  0.82251884  0.13546043
28     28           6_2  1  5  1 2 1 2  0.015538517  0.09759292  0.05656572
29     29           7_1  1  4  2 2 2 1 -0.241692886  0.68765825  0.22298268
30     30           7_3  1  4  2 1 2 2 -1.925982237 -0.02142587 -0.97370405
31     31           7_4  1  3  1 1 2 2 -0.786531996  0.37240589 -0.20706305
32     32           7_2  1  1  1 1 1 1 -1.036532248  0.03740182 -0.49956521
33     33           9_1  2  1  2 2 1 2  0.301151287  1.32567120  0.81341124
34     34           9_3  2  4  1 2 1 2  0.099442728 -0.64992508 -0.27524118
35     35           9_4  2  1  2 1 2 2  0.180172453  0.47473955  0.32745600
36     36           9_2  2  2  1 1 2 2 -0.878034268  0.11541346 -0.38131041
37     37           4_1  2  5  2 2 1 2  1.264621683  2.03276689  1.64869429
38     38           4_3  2  4  1 1 1 1  0.135096464  0.29588664  0.21549155
39     39           4_4  2  3  2 2 1 2  1.332573195  0.47474522  0.90365921
40     40           4_2  2  5  2 1 2 2 -0.524121209  0.21070909 -0.15670606
41     41           1_1  1  4  2 2 1 2  0.566269894  0.99873058  0.78250024
42     42           1_3  2  6  1 1 2 2 -0.016037835 -0.07772310 -0.04688047
43     43           1_4  1  1  1 2 1 2  1.105815610  0.19463846  0.65022703
44     44           1_2  1  6  2 1 2 2  0.660338677 -2.34707817 -0.84336975
45     45          12_1  1  6  2 2 2 1 -0.136857788  0.93683049  0.39998635
46     46          12_3  2  4  1 1 2 2  0.847171812 -0.79710838  0.02503172
47     47          12_4  2  5  2 2 2 1  0.229650044  0.45783819  0.34374412
48     48          12_2  1  4  2 1 1 1 -0.256478646  0.30369296  0.02360716
class=design, type= crossed 
NOTE: columns run.no and run.no.std.rp are annotation, not part of the data frame
> aggregate(plan,response="y",FUN=sd)
   run.no run.no.std.rp C1 C2 C3 A B C          y.1         y.2         y.sd
1       1           2_1  1  3  1 2 1 2 -0.851150416 -1.05302532 0.1427471140
2       2           2_3  1  5  1 2 2 1  0.006271484 -0.90117767 0.6416634538
3       3           2_4  1  2  2 2 2 1  0.548169124  0.54762139 0.0003873083
4       4           2_2  1  6  2 1 1 1 -0.181851424 -0.78673867 0.4277198754
5       5           8_1  2  3  2 1 2 2 -1.235746194 -0.74992867 0.3435248632
6       6           8_3  1  5  1 1 1 1  0.813509703 -0.27667395 0.7708762537
7       7           8_4  2  2  1 2 1 2 -0.508715302 -0.70463704 0.1385375921
8       8           8_2  1  2  2 2 1 2 -0.727584111 -0.23652282 0.3472327686
9       9           3_1  2  1  2 1 1 1 -0.232593151 -1.11208911 0.6218975536
10     10           3_3  2  5  2 1 1 1 -0.930863963  1.42213606 1.6638222741
11     11           3_4  1  2  2 1 2 2  0.143687239  2.74344725 1.8383079324
12     12           3_2  2  2  1 2 2 1 -1.822179128 -0.62036368 0.8498118508
13     13          10_1  1  5  1 1 2 2  0.382546265 -0.18896758 0.4041213167
14     14          10_3  2  3  2 2 2 1  1.305736592  2.78390388 1.0452221137
15     15          10_4  2  1  2 2 2 1 -0.249175840  0.51246844 0.5385638374
16     16          10_2  2  6  1 2 2 1 -0.374453991 -0.37659472 0.0015137250
17     17           5_1  1  3  1 2 2 1 -0.881303105 -0.87684691 0.0031510090
18     18           5_3  2  6  1 2 1 2 -0.359864883 -0.29522781 0.0457053128
19     19           5_4  2  6  1 1 1 1 -1.537593318 -0.06627631 1.0403782351
20     20           5_2  1  3  1 1 1 1  0.854983068 -0.71287670 1.1086442747
21     21          11_1  2  4  1 2 2 1  0.159779702  1.82256585 1.1757673608
22     22          11_3  1  6  2 2 1 2 -0.924768441 -0.51237670 0.2916049998
23     23          11_4  1  1  1 2 2 1 -1.005049325 -0.38943788 0.4353030251
24     24          11_2  2  3  2 1 1 1 -1.503285614  0.44597042 1.3783321607
25     25           6_1  1  2  2 1 1 1 -1.297851905  1.06399304 1.6700765762
26     26           6_3  2  2  1 1 1 1 -0.081346903 -0.14771380 0.0469284848
27     27           6_4  1  1  1 1 2 2 -0.551597973  0.82251884 0.9716473155
28     28           6_2  1  5  1 2 1 2  0.015538517  0.09759292 0.0580212242
29     29           7_1  1  4  2 2 2 1 -0.241692886  0.68765825 0.6571504890
30     30           7_3  1  4  2 1 2 2 -1.925982237 -0.02142587 1.3467247246
31     31           7_4  1  3  1 1 2 2 -0.786531996  0.37240589 0.8194928402
32     32           7_2  1  1  1 1 1 1 -1.036532248  0.03740182 0.7593860653
33     33           9_1  2  1  2 2 1 2  0.301151287  1.32567120 0.7244449751
34     34           9_3  2  4  1 2 1 2  0.099442728 -0.64992508 0.5298830605
35     35           9_4  2  1  2 1 2 2  0.180172453  0.47473955 0.2082903908
36     36           9_2  2  2  1 1 2 2 -0.878034268  0.11541346 0.7024736224
37     37           4_1  2  5  2 2 1 2  1.264621683  2.03276689 0.5431606848
38     38           4_3  2  4  1 1 1 1  0.135096464  0.29588664 0.1136958240
39     39           4_4  2  3  2 2 1 2  1.332573195  0.47474522 0.6065759750
40     40           4_2  2  5  2 1 2 2 -0.524121209  0.21070909 0.5196034879
41     41           1_1  1  4  2 2 1 2  0.566269894  0.99873058 0.3057958869
42     42           1_3  2  6  1 1 2 2 -0.016037835 -0.07772310 0.0436180721
43     43           1_4  1  1  1 2 1 2  1.105815610  0.19463846 0.6442995428
44     44           1_2  1  6  2 1 2 2  0.660338677 -2.34707817 2.1265648494
45     45          12_1  1  6  2 2 2 1 -0.136857788  0.93683049 0.7592122599
46     46          12_3  2  4  1 1 2 2  0.847171812 -0.79710838 1.1626816742
47     47          12_4  2  5  2 2 2 1  0.229650044  0.45783819 0.1613533864
48     48          12_2  1  4  2 1 1 1 -0.256478646  0.30369296 0.3961011414
class=design, type= crossed 
NOTE: columns run.no and run.no.std.rp are annotation, not part of the data frame
> 
> proc.time()
   user  system elapsed 
   0.53    0.12    0.65 
